{"remainingRequest":"/app/appfront/node_modules/babel-loader/lib/index.js!/app/appfront/node_modules/cache-loader/dist/cjs.js??ref--0-0!/app/appfront/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/appfront/src/components/wechat/msgitem.vue?vue&type=script&lang=js&","dependencies":[{"path":"/app/appfront/src/components/wechat/msgitem.vue","mtime":1608703131000},{"path":"/app/appfront/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/app/appfront/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/app/appfront/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/app/appfront/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KZXhwb3J0IGRlZmF1bHQgewogIHByb3BzOiBbIml0ZW0iXSwKCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHJlYWQ6IHRoaXMuaXRlbS5yZWFkLAogICAgICBkZWxldGVNc2c6IGZhbHNlCiAgICB9OwogIH0sCgogIG1ldGhvZHM6IHsKICAgIC8v5YiH5o2i5raI5oGv5pyq6K+7L+W3suivu+eKtuaAgQogICAgdG9nZ2xlTXNnUmVhZChldmVudCwgc3RhdHVzKSB7CiAgICAgIGlmIChzdGF0dXMgPT09ICdlbnRlcicpIHsKICAgICAgICBpZiAodGhpcy5yZWFkKSB7CiAgICAgICAgICByZXR1cm4gJyc7CiAgICAgICAgfQoKICAgICAgICB0aGlzLnJlYWQgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucmVhZCA9ICF0aGlzLnJlYWQ7CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5pdGVtLnF1aWV0KSB7CiAgICAgICAgaWYgKHRoaXMucmVhZCkgewogICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdtaW51c05ld01zZycpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2FkZE5ld01zZycpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZXZlbnQudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5maXJzdENoaWxkLnN0eWxlLm1hcmdpbkxlZnQgPSAwICsgInB4IjsKICAgIH0sCgogICAgZGVsZXRlTXNnRXZlbnQoKSB7CiAgICAgIHRoaXMuZGVsZXRlTXNnID0gdHJ1ZTsKCiAgICAgIGlmICghdGhpcy5pdGVtLnF1aWV0KSB7CiAgICAgICAgaWYgKCF0aGlzLnJlYWQpIHsKICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnbWludXNOZXdNc2cnKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgfSwKICAvLyDlj4LogIMgaHR0cHM6Ly92dWVmZS5jbi92Mi9ndWlkZS9jdXN0b20tZGlyZWN0aXZlLmh0bWwKICBkaXJlY3RpdmVzOiB7CiAgICBzd2lwZXI6IHsKICAgICAgYmluZDogZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICB2YXIgaXNUb3VjaE1vdmUsIHN0YXJ0VHgsIHN0YXJ0VHk7CiAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHZhciB0b3VjaGVzID0gZS50b3VjaGVzWzBdOwogICAgICAgICAgc3RhcnRUeCA9IHRvdWNoZXMuY2xpZW50WDsKICAgICAgICAgIHN0YXJ0VHkgPSB0b3VjaGVzLmNsaWVudFk7CiAgICAgICAgICBpc1RvdWNoTW92ZSA9IGZhbHNlOwogICAgICAgIH0pOwogICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgIHZhciB0b3VjaGVzID0gZS5jaGFuZ2VkVG91Y2hlc1swXSwKICAgICAgICAgICAgICBlbmRUeCA9IHRvdWNoZXMuY2xpZW50WCwKICAgICAgICAgICAgICBlbmRUeSA9IHRvdWNoZXMuY2xpZW50WSwKICAgICAgICAgICAgICBkaXN0YW5jZVggPSBzdGFydFR4IC0gZW5kVHgsCiAgICAgICAgICAgICAgZGlzdGFuY2VZID0gc3RhcnRUeSAtIGVuZFR5OwoKICAgICAgICAgIGlmIChkaXN0YW5jZVggPCAwKSB7CiAgICAgICAgICAgIC8v5Y+z5ruRCiAgICAgICAgICAgIGlmIChNYXRoLmFicyhkaXN0YW5jZVgpID49IE1hdGguYWJzKGRpc3RhbmNlWSkpIHsKICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoZGlzdGFuY2VYKSA+IDIwKSB7CiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnRyYW5zaXRpb24gPSAiMC4zcyI7CiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLm1hcmdpbkxlZnQgPSAwICsgInB4IjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8v5bem5ruRCiAgICAgICAgICAgIGlmIChNYXRoLmFicyhkaXN0YW5jZVgpID49IE1hdGguYWJzKGRpc3RhbmNlWSkpIHsKICAgICAgICAgICAgICBpZiAoZGlzdGFuY2VYIDwgMTU2ICYmIGRpc3RhbmNlWCA+IDIwKSB7CiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnRyYW5zaXRpb24gPSAiMHMiOwogICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5tYXJnaW5MZWZ0ID0gLWRpc3RhbmNlWCArICJweCI7CiAgICAgICAgICAgICAgICBpc1RvdWNoTW92ZSA9IHRydWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAgcGFzc2l2ZTogZmFsc2UKICAgICAgICB9KTsKICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGlmICghaXNUb3VjaE1vdmUpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciB0b3VjaGVzID0gZS5jaGFuZ2VkVG91Y2hlc1swXSwKICAgICAgICAgICAgICBlbmRUeCA9IHRvdWNoZXMuY2xpZW50WCwKICAgICAgICAgICAgICBlbmRUeSA9IHRvdWNoZXMuY2xpZW50WSwKICAgICAgICAgICAgICBkaXN0YW5jZVggPSBzdGFydFR4IC0gZW5kVHgsCiAgICAgICAgICAgICAgZGlzdGFuY2VZID0gc3RhcnRUeSAtIGVuZFR5OyAvLyBpc1N3aXBlID0gZmFsc2UKCiAgICAgICAgICBpZiAoTWF0aC5hYnMoZGlzdGFuY2VYKSA+PSBNYXRoLmFicyhkaXN0YW5jZVkpKSB7CiAgICAgICAgICAgIGlmIChkaXN0YW5jZVggPCAwKSB7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoTWF0aC5hYnMoZGlzdGFuY2VYKSA8IDYwKSB7CiAgICAgICAgICAgICAgLy8gaXNTd2lwZSA9IHRydWUKICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnRyYW5zaXRpb24gPSAiMC4zcyI7CiAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5tYXJnaW5MZWZ0ID0gMCArICJweCI7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS50cmFuc2l0aW9uID0gIjAuM3MiOwogICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUubWFyZ2luTGVmdCA9ICItMTU2cHgiOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9Cn07"},{"version":3,"sources":["msgitem.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <!--消息列表组件 数据交互频繁-->\n    <!--进入 dialogue 页面，携带参数 mid name group_num -->\n    <li :class=\"{'item-hide':deleteMsg}\">\n        <!--自定义指令 v-swiper 用于对每个消息进行滑动处理-->\n        <router-link\n            :to=\"{ path: '/wechat/dialogue', query: { mid: item.mid,name:item.group_name||(item.user[0].remark||item.user[0].nickname),group_num:item.user.length}}\"\n            tag=\"div\" class=\"list-info\" v-swiper v-on:click.native=\"toggleMsgRead($event,'enter')\">\n            <div class=\"header-box\">\n                <!--未读并且未屏蔽 才显示新信息数量-->\n                <i class=\"new-msg-count\" v-show=\"!read&&!item.quiet\">{{item.msg.length}}</i>\n                <!--未读并且屏蔽 只显示小红点-->\n                <i class=\"new-msg-dot\" v-show=\"!read&&item.quiet\"></i>\n                <!--如果是私聊，只显示一个头像； 如果是群聊，则显示多个头像，flex 控制样式-->\n                <div class=\"header\" :class=\"[item.type=='group'?'multi-header':'']\">\n                    <img v-for=\"(userInfo,index) in item.user\" :key=\"index\" :src=\"userInfo.headerUrl\">\n                </div>\n            </div>\n            <div class=\"desc-box\">\n                <!--使用过滤器 fmtDate 格式化时间-->\n                <div class=\"desc-time\">{{item.msg[item.msg.length-1].date | fmtDate('hh:ss')}}</div>\n                <div class=\"desc-author\" v-if=\"item.type=='group'\">{{item.group_name}}</div>\n                <!--如果没有备注好友，则显示微信昵称-->\n                <div class=\"desc-author\" v-else>{{item.user[0].remark||item.user[0].nickname}}</div>\n                <div class=\"desc-msg\">\n                    <div class=\"desc-mute iconfont icon-mute\" v-show=\"item.quiet\">\n                    </div>\n                    <span v-show=\"item.type=='group'\">{{item.msg[item.msg.length-1].name}}:</span>\n                    <span>{{item.msg[item.msg.length-1].text}}</span>\n                </div>\n            </div>\n        </router-link>\n        <div class=\"operate-box\">\n            <div class=\"operate-unread\" v-if=\"read\" v-on:click=\"toggleMsgRead\">标为未读</div>\n            <div class=\"operate-read\" v-else v-on:click=\"toggleMsgRead\">标为已读</div>\n            <div class=\"operate-del\" v-on:click=\"deleteMsgEvent\">删除</div>\n        </div>\n    </li>\n</template>\n<script>\n    export default {\n        props: [\"item\"],\n        data() {\n            return {\n                read: this.item.read,\n                deleteMsg: false\n            }\n        },\n        methods: {\n            //切换消息未读/已读状态\n            toggleMsgRead(event, status) {\n                if (status === 'enter') {\n                    if (this.read) {\n                        return ''\n                    }\n                    this.read = true\n                } else {\n                    this.read = !this.read\n                }\n                if (!this.item.quiet) {\n                    if (this.read) {\n                        this.$store.commit('minusNewMsg')\n                    } else {\n                        this.$store.commit('addNewMsg')\n                    }\n                }\n\n                event.target.parentNode.parentNode.firstChild.style.marginLeft = 0 + \"px\"\n            },\n            deleteMsgEvent() {\n                this.deleteMsg = true\n                if (!this.item.quiet) {\n                    if (!this.read) {\n                        this.$store.commit('minusNewMsg')\n                    }\n                }\n            }\n        },\n        // 参考 https://vuefe.cn/v2/guide/custom-directive.html\n        directives: {\n            swiper: {\n                bind: function (element) {\n                    var isTouchMove, startTx, startTy\n                    element.addEventListener('touchstart', function (e) {\n                        var touches = e.touches[0]\n                        startTx = touches.clientX\n                        startTy = touches.clientY\n                        isTouchMove = false;\n                    });\n                    element.addEventListener('touchmove', function (e) {\n                        e.preventDefault();\n                        var touches = e.changedTouches[0],\n                            endTx = touches.clientX,\n                            endTy = touches.clientY,\n                            distanceX = startTx - endTx,\n                            distanceY = startTy - endTy;\n                        if (distanceX < 0) { //右滑\n                            if (Math.abs(distanceX) >= Math.abs(distanceY)) {\n                                if (Math.abs(distanceX) > 20) {\n                                    element.style.transition = \"0.3s\"\n                                    element.style.marginLeft = 0 + \"px\"\n                                }\n                            }\n                        } else { //左滑\n                            if (Math.abs(distanceX) >= Math.abs(distanceY)) {\n                                if (distanceX < 156 && distanceX > 20) {\n                                    element.style.transition = \"0s\"\n                                    element.style.marginLeft = -distanceX + \"px\"\n                                    isTouchMove = true\n                                }\n                            }\n                        }\n                    }, { passive: false });\n                    element.addEventListener('touchend', function (e) {\n                        if (!isTouchMove) {\n                            return;\n                        }\n                        var touches = e.changedTouches[0],\n                            endTx = touches.clientX,\n                            endTy = touches.clientY,\n                            distanceX = startTx - endTx,\n                            distanceY = startTy - endTy\n                        // isSwipe = false\n                        if (Math.abs(distanceX) >= Math.abs(distanceY)) {\n                            if (distanceX < 0) {\n                                return;\n                            }\n                            if (Math.abs(distanceX) < 60) {\n                                // isSwipe = true\n                                element.style.transition = \"0.3s\"\n                                element.style.marginLeft = 0 + \"px\"\n                            } else {\n                                element.style.transition = \"0.3s\"\n                                element.style.marginLeft = \"-156px\"\n                            }\n                        }\n                    });\n                }\n            }\n        }\n    }\n</script>"],"sourceRoot":"src/components/wechat"}]}